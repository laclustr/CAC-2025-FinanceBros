---
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/starwind/select";
interface Props {
  id: string;
  name: string;
  label: string;
  type: 'text' | 'number' | 'date' | 'select';
  options?: string[];
  placeholder?: string;
  step?: string;
  focusColor: 'red' | 'green' | 'blue';
}

const { id, name, label, type, placeholder, step, focusColor, options } = Astro.props;

const focusClasses = {
  red: 'focus:ring-red-500',
  green: 'focus:ring-green-500',
  blue: 'focus:ring-blue-500',
};
---

<div>
  <label for={id} class="block text-sm font-medium text-gray-700 mb-2">
    {label}
  </label>

  {type === 'select' ? (
    <Select>
      <SelectTrigger
        class={`w-full text-left px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg bg-white ${focusClasses[focusColor]} focus:outline-none focus:ring-2 transition-colors text-sm sm:text-base`}
      >
        <span id={`${id}-selected-text`}>{placeholder ?? 'Select an option'}</span>
      </SelectTrigger>

      <SelectContent class="w-full max-h-60 overflow-y-auto">
        {(options ?? []).map((option) => (
          <SelectItem
            key={option}
            onSelect={() => {
              const input = document.getElementById(id) as HTMLInputElement;
              const display = document.getElementById(`${id}-selected-text`);
              if (input && display) {
                input.value = option;
                input.dispatchEvent(new Event('input', { bubbles: true }));
                display.textContent = option;
              }
            }}
          >
            {option}
          </SelectItem>
        ))}
      </SelectContent>

      <input type="hidden" id={id} name={name} value="" />
    </Select>
  ) : (
    <input
      type={type}
      id={id}
      name={name}
      placeholder={placeholder}
      step={step}
      class={`w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg ${focusClasses[focusColor]} focus:border-transparent transition-colors text-sm sm:text-base focus:ring-2`}
    />
  )}

  <div class="error-message hidden text-red-600 text-xs sm:text-sm mt-1"></div>
</div>