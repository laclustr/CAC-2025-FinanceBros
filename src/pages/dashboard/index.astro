---
import { verifyToken } from '../api/verify-token';

const { cookies, redirect } = Astro;
const token = cookies.get('token')?.value;

const user = await verifyToken(token);

if (!user) {
  return redirect('/login/sign-in');
}
---

<html>
  <head><title>Dashboard</title></head>
  <body>
    <h1>Welcome, {user.email}!</h1>
    <form action="/api/logout" method="POST">
      <button type="submit">Logout</button>
    </form>
  </body>
</html>
